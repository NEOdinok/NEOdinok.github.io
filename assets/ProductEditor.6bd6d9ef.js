import{t as De,v as J,x as Ne,y as Ae,z as oe,A as ce,C as pe,E as ae,D as de,r as w,a as _,w as R,i as ne,h as k,ay as Te,bx as ze,b as ve,S as Ee,by as Ue,c as me,bz as Me,be as Oe,o as ue,l as fe,bA as ge,p as Be,q as Qe,T as je,bB as Re,f as X,I as Le,s as We,b7 as He,bf as Ke,b8 as Xe,ba as Ye,bg as Je,bC as Ge,bh as ye,bD as Ze,b9 as et,B as tt,a4 as we,a7 as L,ag as G,ab as B,bE as at,a9 as H,Q as $e,a1 as nt,aJ as ot,bw as lt,a8 as le,ae as K,aL as re,aM as z,ai as rt,ah as it,al as be,ac as ut,ad as st}from"./index.544219da.js";import{b as ct,a as qe,c as Ie,u as dt,Q as he}from"./QSelect.f94f63f8.js";import{g as xe,s as Ce}from"./touch.3df10340.js";import{c as vt,h as mt}from"./format.3ab41e4b.js";import{Q as ft}from"./QForm.129fbcb6.js";import{u as pt,r as ee,i as _e,m as Pe}from"./index.6b351daa.js";function gt(e){const o=[.06,6,50];return typeof e=="string"&&e.length&&e.split(":").forEach((v,g)=>{const l=parseFloat(v);l&&(o[g]=l)}),o}var yt=De({name:"touch-swipe",beforeMount(e,{value:o,arg:v,modifiers:g}){if(g.mouse!==!0&&J.has.touch!==!0)return;const l=g.mouseCapture===!0?"Capture":"",t={handler:o,sensitivity:gt(v),direction:xe(g),noop:Ne,mouseStart(u){Ce(u,t)&&Ae(u)&&(oe(t,"temp",[[document,"mousemove","move",`notPassive${l}`],[document,"mouseup","end","notPassiveCapture"]]),t.start(u,!0))},touchStart(u){if(Ce(u,t)){const m=u.target;oe(t,"temp",[[m,"touchmove","move","notPassiveCapture"],[m,"touchcancel","end","notPassiveCapture"],[m,"touchend","end","notPassiveCapture"]]),t.start(u)}},start(u,m){J.is.firefox===!0&&ce(e,!0);const P=pe(u);t.event={x:P.left,y:P.top,time:Date.now(),mouse:m===!0,dir:!1}},move(u){if(t.event===void 0)return;if(t.event.dir!==!1){ae(u);return}const m=Date.now()-t.event.time;if(m===0)return;const P=pe(u),q=P.left-t.event.x,f=Math.abs(q),I=P.top-t.event.y,S=Math.abs(I);if(t.event.mouse!==!0){if(f<t.sensitivity[1]&&S<t.sensitivity[1]){t.end(u);return}}else if(window.getSelection().toString()!==""){t.end(u);return}else if(f<t.sensitivity[2]&&S<t.sensitivity[2])return;const D=f/m,N=S/m;t.direction.vertical===!0&&f<S&&f<100&&N>t.sensitivity[0]&&(t.event.dir=I<0?"up":"down"),t.direction.horizontal===!0&&f>S&&S<100&&D>t.sensitivity[0]&&(t.event.dir=q<0?"left":"right"),t.direction.up===!0&&f<S&&I<0&&f<100&&N>t.sensitivity[0]&&(t.event.dir="up"),t.direction.down===!0&&f<S&&I>0&&f<100&&N>t.sensitivity[0]&&(t.event.dir="down"),t.direction.left===!0&&f>S&&q<0&&S<100&&D>t.sensitivity[0]&&(t.event.dir="left"),t.direction.right===!0&&f>S&&q>0&&S<100&&D>t.sensitivity[0]&&(t.event.dir="right"),t.event.dir!==!1?(ae(u),t.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),vt(),t.styleCleanup=p=>{t.styleCleanup=void 0,document.body.classList.remove("non-selectable");const E=()=>{document.body.classList.remove("no-pointer-events--children")};p===!0?setTimeout(E,50):E()}),t.handler({evt:u,touch:t.event.mouse!==!0,mouse:t.event.mouse,direction:t.event.dir,duration:m,distance:{x:f,y:S}})):t.end(u)},end(u){t.event!==void 0&&(de(t,"temp"),J.is.firefox===!0&&ce(e,!1),t.styleCleanup!==void 0&&t.styleCleanup(!0),u!==void 0&&t.event.dir!==!1&&ae(u),t.event=void 0)}};if(e.__qtouchswipe=t,g.mouse===!0){const u=g.mouseCapture===!0||g.mousecapture===!0?"Capture":"";oe(t,"main",[[e,"mousedown","mouseStart",`passive${u}`]])}J.has.touch===!0&&oe(t,"main",[[e,"touchstart","touchStart",`passive${g.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,o){const v=e.__qtouchswipe;v!==void 0&&(o.oldValue!==o.value&&(typeof o.value!="function"&&v.end(),v.handler=o.value),v.direction=xe(o.modifiers))},beforeUnmount(e){const o=e.__qtouchswipe;o!==void 0&&(de(o,"main"),de(o,"temp"),J.is.firefox===!0&&ce(e,!1),o.styleCleanup!==void 0&&o.styleCleanup(),delete e.__qtouchswipe)}});function bt(){const e=new Map;return{getCache:function(o,v){return e[o]===void 0?e[o]=v:e[o]},getCacheWithFn:function(o,v){return e[o]===void 0?e[o]=v():e[o]}}}const ht={name:{required:!0},disable:Boolean},Se={setup(e,{slots:o}){return()=>k("div",{class:"q-panel scroll",role:"tabpanel"},ve(o.default))}},xt={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},Ct=["update:modelValue","beforeTransition","transition"];function _t(){const{props:e,emit:o,proxy:v}=ne(),{getCacheWithFn:g}=bt();let l,t;const u=w(null),m=w(null);function P(r){const s=e.vertical===!0?"up":"left";F((v.$q.lang.rtl===!0?-1:1)*(r.direction===s?1:-1))}const q=_(()=>[[yt,P,void 0,{horizontal:e.vertical!==!0,vertical:e.vertical,mouse:!0}]]),f=_(()=>e.transitionPrev||`slide-${e.vertical===!0?"down":"right"}`),I=_(()=>e.transitionNext||`slide-${e.vertical===!0?"up":"left"}`),S=_(()=>`--q-transition-duration: ${e.transitionDuration}ms`),D=_(()=>typeof e.modelValue=="string"||typeof e.modelValue=="number"?e.modelValue:String(e.modelValue)),N=_(()=>({include:e.keepAliveInclude,exclude:e.keepAliveExclude,max:e.keepAliveMax})),p=_(()=>e.keepAliveInclude!==void 0||e.keepAliveExclude!==void 0);R(()=>e.modelValue,(r,s)=>{const T=$(r)===!0?y(r):-1;t!==!0&&c(T===-1?0:T<y(s)?-1:1),u.value!==T&&(u.value=T,o("beforeTransition",r,s),Ee(()=>{o("transition",r,s)}))});function E(){F(1)}function A(){F(-1)}function i(r){o("update:modelValue",r)}function $(r){return r!=null&&r!==""}function y(r){return l.findIndex(s=>s.props.name===r&&s.props.disable!==""&&s.props.disable!==!0)}function V(){return l.filter(r=>r.props.disable!==""&&r.props.disable!==!0)}function c(r){const s=r!==0&&e.animated===!0&&u.value!==-1?"q-transition--"+(r===-1?f.value:I.value):null;m.value!==s&&(m.value=s)}function F(r,s=u.value){let T=s+r;for(;T>-1&&T<l.length;){const j=l[T];if(j!==void 0&&j.props.disable!==""&&j.props.disable!==!0){c(r),t=!0,o("update:modelValue",j.props.name),setTimeout(()=>{t=!1});return}T+=r}e.infinite===!0&&l.length!==0&&s!==-1&&s!==l.length&&F(r,r===-1?l.length:-1)}function U(){const r=y(e.modelValue);return u.value!==r&&(u.value=r),!0}function C(){const r=$(e.modelValue)===!0&&U()&&l[u.value];return e.keepAlive===!0?[k(Ue,N.value,[k(p.value===!0?g(D.value,()=>({...Se,name:D.value})):Se,{key:D.value,style:S.value},()=>r)])]:[k("div",{class:"q-panel scroll",style:S.value,key:D.value,role:"tabpanel"},[r])]}function d(){if(l.length!==0)return e.animated===!0?[k(Te,{name:m.value},C)]:C()}function M(r){return l=ze(ve(r.default,[])).filter(s=>s.props!==null&&s.props.slot===void 0&&$(s.props.name)===!0),l.length}function h(){return l}return Object.assign(v,{next:E,previous:A,goTo:i}),{panelIndex:u,panelDirectives:q,updatePanelsList:M,updatePanelIndex:U,getPanelContent:d,getEnabledPanels:V,getPanels:h,isValidPanelName:$,keepAliveProps:N,needsUniqueKeepAliveWrapper:p,goToPanelByOffset:F,goToPanel:i,nextPanel:E,previousPanel:A}}var Fe=me({name:"QCarouselSlide",props:{...ht,imgSrc:String},setup(e,{slots:o}){const v=_(()=>e.imgSrc?{backgroundImage:`url("${e.imgSrc}")`}:{});return()=>k("div",{class:"q-carousel__slide",style:v.value},ve(o.default))}});let te=0;const Pt={fullscreen:Boolean,noRouteFullscreenExit:Boolean},St=["update:fullscreen","fullscreen"];function Ft(){const e=ne(),{props:o,emit:v,proxy:g}=e;let l,t,u;const m=w(!1);Me(e)===!0&&R(()=>g.$route.fullPath,()=>{o.noRouteFullscreenExit!==!0&&f()}),R(()=>o.fullscreen,I=>{m.value!==I&&P()}),R(m,I=>{v("update:fullscreen",I),v("fullscreen",I)});function P(){m.value===!0?f():q()}function q(){m.value!==!0&&(m.value=!0,u=g.$el.parentNode,u.replaceChild(t,g.$el),document.body.appendChild(g.$el),te++,te===1&&document.body.classList.add("q-body--fullscreen-mixin"),l={handler:f},ge.add(l))}function f(){m.value===!0&&(l!==void 0&&(ge.remove(l),l=void 0),u.replaceChild(g.$el,t),m.value=!1,te=Math.max(0,te-1),te===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),g.$el.scrollIntoView!==void 0&&setTimeout(()=>{g.$el.scrollIntoView()})))}return Oe(()=>{t=document.createElement("span")}),ue(()=>{o.fullscreen===!0&&q()}),fe(f),Object.assign(g,{toggleFullscreen:P,setFullscreen:q,exitFullscreen:f}),{inFullscreen:m,toggleFullscreen:P}}const wt=["top","right","bottom","left"],$t=["regular","flat","outline","push","unelevated"];var qt=me({name:"QCarousel",props:{...Be,...xt,...Pt,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:e=>$t.includes(e),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:e=>wt.includes(e)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...St,...Ct],setup(e,{slots:o}){const{proxy:{$q:v}}=ne(),g=Qe(e,v);let l=null,t;const{updatePanelsList:u,getPanelContent:m,panelDirectives:P,goToPanel:q,previousPanel:f,nextPanel:I,getEnabledPanels:S,panelIndex:D}=_t(),{inFullscreen:N}=Ft(),p=_(()=>N.value!==!0&&e.height!==void 0?{height:e.height}:{}),E=_(()=>e.vertical===!0?"vertical":"horizontal"),A=_(()=>`q-carousel q-panel-parent q-carousel--with${e.padding===!0?"":"out"}-padding`+(N.value===!0?" fullscreen":"")+(g.value===!0?" q-carousel--dark q-dark":"")+(e.arrows===!0?` q-carousel--arrows-${E.value}`:"")+(e.navigation===!0?` q-carousel--navigation-${V.value}`:"")),i=_(()=>{const d=[e.prevIcon||v.iconSet.carousel[e.vertical===!0?"up":"left"],e.nextIcon||v.iconSet.carousel[e.vertical===!0?"down":"right"]];return e.vertical===!1&&v.lang.rtl===!0?d.reverse():d}),$=_(()=>e.navigationIcon||v.iconSet.carousel.navigationIcon),y=_(()=>e.navigationActiveIcon||$.value),V=_(()=>e.navigationPosition||(e.vertical===!0?"right":"bottom")),c=_(()=>({color:e.controlColor,textColor:e.controlTextColor,round:!0,[e.controlType]:!0,dense:!0}));R(()=>e.modelValue,()=>{e.autoplay&&F()}),R(()=>e.autoplay,d=>{d?F():l!==null&&(clearTimeout(l),l=null)});function F(){const d=Re(e.autoplay)===!0?Math.abs(e.autoplay):5e3;l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,d>=0?I():f()},d)}ue(()=>{e.autoplay&&F()}),fe(()=>{l!==null&&clearTimeout(l)});function U(d,M){return k("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${d} q-carousel__navigation--${V.value}`+(e.controlColor!==void 0?` text-${e.controlColor}`:"")},[k("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},S().map(M))])}function C(){const d=[];if(e.navigation===!0){const M=o["navigation-icon"]!==void 0?o["navigation-icon"]:r=>k(X,{key:"nav"+r.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${r.active===!0?"":"in"}active`,...r.btnProps,onClick:r.onClick}),h=t-1;d.push(U("buttons",(r,s)=>{const T=r.props.name,j=D.value===s;return M({index:s,maxIndex:h,name:T,active:j,btnProps:{icon:j===!0?y.value:$.value,size:"sm",...c.value},onClick:()=>{q(T)}})}))}else if(e.thumbnails===!0){const M=e.controlColor!==void 0?` text-${e.controlColor}`:"";d.push(U("thumbnails",h=>{const r=h.props;return k("img",{key:"tmb#"+r.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${r.name===e.modelValue?"":"in"}active`+M,src:r.imgSrc||r["img-src"],onClick:()=>{q(r.name)}})}))}return e.arrows===!0&&D.value>=0&&((e.infinite===!0||D.value>0)&&d.push(k("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${E.value} absolute flex flex-center`},[k(X,{icon:i.value[0],...c.value,onClick:f})])),(e.infinite===!0||D.value<t-1)&&d.push(k("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${E.value} absolute flex flex-center`},[k(X,{icon:i.value[1],...c.value,onClick:I})]))),Le(o.control,d)}return()=>(t=u(o),k("div",{class:A.value,style:p.value},[je("div",{class:"q-carousel__slides-container"},m(),"sl-cont",e.swipeable,()=>P.value)].concat(C())))}});function Y(e,o,v,g){const l=[];return e.forEach(t=>{g(t)===!0?l.push(t):o.push({failedPropValidation:v,file:t})}),l}function ie(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),ae(e)}const It={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Vt=["rejected"];function kt({editable:e,dnd:o,getFileInput:v,addFilesToQueue:g}){const{props:l,emit:t,proxy:u}=ne(),m=w(null),P=_(()=>l.accept!==void 0?l.accept.split(",").map(i=>(i=i.trim(),i==="*"?"*/":(i.endsWith("/*")&&(i=i.slice(0,i.length-1)),i.toUpperCase()))):null),q=_(()=>parseInt(l.maxFiles,10)),f=_(()=>parseInt(l.maxTotalSize,10));function I(i){if(e.value)if(i!==Object(i)&&(i={target:null}),i.target!==null&&i.target.matches('input[type="file"]')===!0)i.clientX===0&&i.clientY===0&&We(i);else{const $=v();$&&$!==i.target&&$.click(i)}}function S(i){e.value&&i&&g(null,i)}function D(i,$,y,V){let c=Array.from($||i.target.files);const F=[],U=()=>{F.length!==0&&t("rejected",F)};if(l.accept!==void 0&&P.value.indexOf("*/")===-1&&(c=Y(c,F,"accept",C=>P.value.some(d=>C.type.toUpperCase().startsWith(d)||C.name.toUpperCase().endsWith(d))),c.length===0))return U();if(l.maxFileSize!==void 0){const C=parseInt(l.maxFileSize,10);if(c=Y(c,F,"max-file-size",d=>d.size<=C),c.length===0)return U()}if(l.multiple!==!0&&c.length!==0&&(c=[c[0]]),c.forEach(C=>{C.__key=C.webkitRelativePath+C.lastModified+C.name+C.size}),V===!0){const C=y.map(d=>d.__key);c=Y(c,F,"duplicate",d=>C.includes(d.__key)===!1)}if(c.length===0)return U();if(l.maxTotalSize!==void 0){let C=V===!0?y.reduce((d,M)=>d+M.size,0):0;if(c=Y(c,F,"max-total-size",d=>(C+=d.size,C<=f.value)),c.length===0)return U()}if(typeof l.filter=="function"){const C=l.filter(c);c=Y(c,F,"filter",d=>C.includes(d))}if(l.maxFiles!==void 0){let C=V===!0?y.length:0;if(c=Y(c,F,"max-files",()=>(C++,C<=q.value)),c.length===0)return U()}if(U(),c.length!==0)return c}function N(i){ie(i),o.value!==!0&&(o.value=!0)}function p(i){ae(i),(i.relatedTarget!==null||J.is.safari!==!0?i.relatedTarget!==m.value:document.elementsFromPoint(i.clientX,i.clientY).includes(m.value)===!1)===!0&&(o.value=!1)}function E(i){ie(i);const $=i.dataTransfer.files;$.length!==0&&g(null,$),o.value=!1}function A(i){if(o.value===!0)return k("div",{ref:m,class:`q-${i}__dnd absolute-full`,onDragenter:ie,onDragover:ie,onDragleave:p,onDrop:E})}return Object.assign(u,{pickFiles:I,addFiles:S}),{pickFiles:I,addFiles:S,onDragover:N,onDragleave:p,processFiles:D,getDndNode:A,maxFilesNumber:q,maxTotalSizeNumber:f}}var Dt=me({name:"QFile",inheritAttrs:!1,props:{...He,...Ke,...It,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Xe,...Vt],setup(e,{slots:o,emit:v,attrs:g}){const{proxy:l}=ne(),t=Ye(),u=w(null),m=w(!1),P=Je(e),{pickFiles:q,onDragover:f,onDragleave:I,processFiles:S,getDndNode:D}=kt({editable:t.editable,dnd:m,getFileInput:h,addFilesToQueue:r}),N=Ge(e),p=_(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),E=_(()=>ye(p.value)),A=_(()=>p.value.map(b=>b.name).join(", ")),i=_(()=>mt(p.value.reduce((b,O)=>b+O.size,0))),$=_(()=>({totalSize:i.value,filesNumber:p.value.length,maxFiles:e.maxFiles})),y=_(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:P.value,...g,id:t.targetUid.value,disabled:t.editable.value!==!0})),V=_(()=>"q-file q-field--auto-height"+(m.value===!0?" q-file--dnd":"")),c=_(()=>e.multiple===!0&&e.append===!0);function F(b){const O=p.value.slice();O.splice(b,1),C(O)}function U(b){const O=p.value.indexOf(b);O>-1&&F(O)}function C(b){v("update:modelValue",e.multiple===!0?b:b[0])}function d(b){b.keyCode===13&&tt(b)}function M(b){(b.keyCode===13||b.keyCode===32)&&q(b)}function h(){return u.value}function r(b,O){const Q=S(b,O,p.value,c.value),Z=h();Z!=null&&(Z.value=""),Q!==void 0&&((e.multiple===!0?e.modelValue&&Q.every(se=>p.value.includes(se)):e.modelValue===Q[0])||C(c.value===!0?p.value.concat(Q):Q))}function s(){return[k("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function T(){if(o.file!==void 0)return p.value.length===0?s():p.value.map((O,Q)=>o.file({index:Q,file:O,ref:this}));if(o.selected!==void 0)return p.value.length===0?s():o.selected({files:p.value,ref:this});if(e.useChips===!0)return p.value.length===0?s():p.value.map((O,Q)=>k(ct,{key:"file-"+Q,removable:t.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{F(Q)}},()=>k("span",{class:"ellipsis",textContent:O.name})));const b=e.displayValue!==void 0?e.displayValue:A.value;return b.length!==0?[k("div",{class:e.inputClass,style:e.inputStyle,textContent:b})]:s()}function j(){const b={ref:u,...y.value,...N.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:r};return e.multiple===!0&&(b.multiple=!0),k("input",b)}return Object.assign(t,{fieldClass:V,emitValue:C,hasValue:E,inputRef:u,innerValue:p,floatingLabel:_(()=>E.value===!0||ye(e.displayValue)),computedCounter:_(()=>{if(e.counterLabel!==void 0)return e.counterLabel($.value);const b=e.maxFiles;return`${p.value.length}${b!==void 0?" / "+b:""} (${i.value})`}),getControlChild:()=>D("file"),getControl:()=>{const b={ref:t.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return t.editable.value===!0&&Object.assign(b,{onDragover:f,onDragleave:I,onKeydown:d,onKeyup:M}),k("div",b,[j()].concat(T()))}}),Object.assign(l,{removeAtIndex:F,removeFile:U,getNativeElement:()=>u.value}),Ze(l,"nativeEl",()=>u.value),et(t)}});const Nt={class:""},At={__name:"FirebaseUpload",emits:["onImagesUploaded"],setup(e,{emit:o}){we();const{triggerSpinner:v}=qe(),{uploadImagesToFirebaseStorage:g}=Ie(),l=w([]),t=w(null),u=_(()=>t.value!==null),m=async()=>{try{const P=v("loading images...");l.value=[],l.value=await g(t.value),l.value&&P(),o("onImagesUploaded",l.value),t.value=null}catch(P){console.warn({error:P})}};return(P,q)=>(L(),G("div",Nt,[B(Dt,{modelValue:t.value,"onUpdate:modelValue":q[0]||(q[0]=f=>t.value=f),label:"Add images to upload",class:"q-pt-md",accept:".jpg, image/*",outlined:"",counter:"",clearable:"",multiple:"",append:"","use-chips":""},at({prepend:H(()=>[B($e,{name:"attach_file"})]),_:2},[u.value?{name:"after",fn:H(()=>[B(X,{color:"green",rounded:"",dense:"",icon:"cloud_upload",disable:!u.value,onClick:m},null,8,["disable"])]),key:"0"}:void 0]),1032,["modelValue"])]))}};const Tt={key:0,class:"spinnerWrap"},zt={class:"row justify-center"},Et={class:"col-12 col-sm-6 col-md-4"},Ut={class:"q-pa-md"},Mt={key:1},Ot={class:"col-12 col-sm-6 col-md-4"},Bt={class:"q-pa-md"},Qt={key:0,class:"custom-caption absolute-top"},jt=K("div",{class:"text-h2"},"Main Image",-1),Rt=[jt],Lt=K("div",{class:"q-mt-md text-center"}," Add product images below ",-1),Wt={key:0,class:"row q-gutter-sm q-pt-md"},Zt={__name:"ProductEditor",props:{productId:{type:String,required:!1}},setup(e){const o=e,{getCategoryDocsFromFirebase:v,getSubcategoryDocsFromFirebase:g,createProductInFirebase:l,getProductFromFirebase:t,updateProductInFirebase:u}=dt(),{removeImageFromFirebaseStorage:m}=Ie();we();const{triggerNegative:P,triggerPositive:q}=qe(),f=w([]),I=w([]),S=w([]),D=w([]),N=w(null),p=w(null),E=w(""),A=w("blank"),i=w(null),$=w(!1),y=w([]),V=w([]),c=w(!1),F=w([]),U=w([]),C=nt(),d=w(!1);w(!1);const M=w(null),h=ot({productName:"",productPrice:"",productQuantity:"",productCategory:"",productSubCategory:"",productDescription:""}),r={productName:{required:ee,$lazy:!0},productPrice:{required:ee,integer:_e,minValue:Pe(1),$lazy:!0},productQuantity:{required:ee,integer:_e,minValue:Pe(1),$lazy:!0},productCategory:{required:ee,$lazy:!0},productSubCategory:{$lazy:!1},productDescription:{required:ee,$lazy:!0}},s=pt(r,h),T=_(()=>!!o.productId);ue(async()=>{if(T.value)try{M.value=await t(o.productId),M&&j(M.value)}catch(n){console.warn({error:n})}}),ue(async()=>{try{const{categoriesData:n}=await v();f.value=n.value}catch({error:n}){console.warn({error:n})}});const j=n=>{h.productName=n.name,h.productPrice=n.price,h.productQuantity=n.quantity,h.productDescription=n.description,h.productCategory=n.category,h.productSubCategory=n.subCategory,N.value=n.category,p.value=n.subCategory,y.value=n.imagesData,V.value=n.imageUrls,console.log("imageUrls filled",V.value),A.value=n.imagesData.find(a=>a.isMain===!0).url,i.value=n.imagesData.find(a=>a.isMain===!0)},b=async()=>{try{if(!await z(s).$validate())P("Fill in all the fields");else if(y.value.length==0)P("Please upload product images");else if(!i.value)P("Please select a main image");else{const a={name:h.productName,price:h.productPrice,quantity:h.productQuantity,description:h.productDescription,category:N.value,subCategory:p.value,imagesData:y.value,imageUrls:V.value};T.value?await O(a):await Q(a),c.value=!0,console.log("submitHandlerRan is set to:",c.value)}}catch(n){console.warn({error:n})}},O=async n=>{try{await u(o.productId,n),q(`Product ${n.name} updated`)}catch(a){console.warn({error:a})}},Q=async n=>{try{const a=await l(n);q(`Product ${n.name} created`),C.replace(`/products/edit/${a}`)}catch(a){console.warn({error:a})}};R(A,n=>{const a=y.value.find(x=>x.url==n);a&&a.isMain==!0?$.value=!0:$.value=!1}),R(f,()=>{I.value=f.value.map(n=>({label:n.categoryName,value:n.categoryId}))}),R(p,n=>{try{if(n)h.productSubCategory=n;else{h.productSubCategory="";return}}catch(a){console.warn({error:a})}h.productSubCategory=n}),R(N,async n=>{try{if(n){h.productCategory=n;const{subcategoriesData:a}=await g(n);S.value=a.value,d.value&&(p.value="")}}catch(a){console.warn({error:a})}}),R(S,n=>{D.value=n.map(a=>({label:a.subCategoryName,value:a.subCategoryId}))});const Z=async()=>{let n=y.value.find(W=>W.url==A.value),a=y.value.indexOf(n);U.value.push(n);const x=[];y.value.forEach(W=>{W.url!=A.value&&x.push(W)}),y.value=x,V.value=[],y.value.forEach(W=>{V.value.push(W.url)}),a==0?A.value=y.value[0].url:A.value=y.value[a-1].url,console.log("imageUrls updated",V.value)},se=n=>{console.log("[editor] uploaded event. uploadedImagesData:",n),n.forEach(a=>{y.value.push(a),V.value.push(a.url),F.value.push(a)}),A.value=y.value[0].url},Ve=async()=>{console.log("[editor] about to find and remove main from",y.value.find(x=>x.isMain===!0)),ke();let n=y.value.find(x=>x.url==A.value),a=y.value.indexOf(n);n.isMain=!0,y.value[a]=n,$.value=!0,i.value=n,console.log("[editor] changed main to",i.value.url),console.log("[editor] update end. imagesData:",y.value)},ke=()=>{let n=y.value.find(a=>a.isMain===!0);if(console.log("[findAndRemove]:",n),n){let a=y.value.indexOf(n);n.isMain=!1,y.value[a]=n}};return fe(async()=>{c.value?console.log("not deleting nothing"):(console.log("product not created. clearing photos"),F.value.length?F.value.map(async n=>{console.log("removed",n.url,"from firebase"),await m(n)}):console.log("no new images uploaded. nothing to clean"))}),(n,a)=>T.value&&!M.value?(L(),G("div",Tt,[B(lt,{color:"primary",size:"3em"})])):(L(),le(ft,{key:1,ref_key:"createProductForm",ref:E,onSubmit:b},{default:H(()=>[K("div",zt,[K("div",Et,[K("div",Ut,[B(re,{outlined:"",label:"Product name",class:"q-pb-lg",modelValue:h.productName,"onUpdate:modelValue":a[0]||(a[0]=x=>h.productName=x),"error-message":"Product name is required","bottom-slots":"",error:z(s).productName.$invalid&&z(s).productName.$dirty,"onUpdate:model":a[1]||(a[1]=x=>z(s).productName.$touch())},null,8,["modelValue","error"]),B(re,{outlined:"",label:"Product price",class:"q-pb-lg",modelValue:h.productPrice,"onUpdate:modelValue":[a[2]||(a[2]=x=>h.productPrice=x),a[3]||(a[3]=x=>z(s).productPrice.$touch())],"error-message":"Please enter valid price","bottom-slots":"",error:z(s).productPrice.$invalid&&z(s).productPrice.$dirty},null,8,["modelValue","error"]),B(re,{class:"q-pb-lg",label:"Product quantity",modelValue:h.productQuantity,"onUpdate:modelValue":[a[4]||(a[4]=x=>h.productQuantity=x),a[5]||(a[5]=x=>z(s).productQuantity.$touch())],"error-message":"Please enter valid quantity",outlined:"","bottom-slots":"",error:z(s).productQuantity.$invalid&&z(s).productQuantity.$dirty},null,8,["modelValue","error"]),I.value.length?(L(),le(he,{key:0,outlined:"",label:"Parent category",class:"q-pb-lg","error-message":"Please select a parent category",options:I.value,modelValue:N.value,"onUpdate:modelValue":[a[6]||(a[6]=x=>N.value=x),a[7]||(a[7]=x=>z(s).productCategory.$touch())],error:z(s).productCategory.$invalid&&z(s).productCategory.$dirty,onPopupShow:a[8]||(a[8]=x=>d.value=!0)},null,8,["options","modelValue","error"])):(L(),G("p",Mt,"No product categories")),B(he,{outlined:"",label:"Product Subcategory",class:"q-pb-lg",modelValue:p.value,"onUpdate:modelValue":[a[9]||(a[9]=x=>p.value=x),a[10]||(a[10]=x=>z(s).productSubCategory.$touch())],options:D.value,"error-message":"Please select a subcategory",error:z(s).productSubCategory.$invalid&&z(s).productSubCategory.$dirty},null,8,["modelValue","options","error"]),B(re,{filled:"",clearable:"",autogrow:"",type:"textarea",color:"primary",label:"Product Description",modelValue:h.productDescription,"onUpdate:modelValue":[a[11]||(a[11]=x=>h.productDescription=x),a[12]||(a[12]=x=>z(s).productDescription.$touch())],"error-message":"Please enter product description",error:z(s).productDescription.$invalid&&z(s).productDescription.$dirty},null,8,["modelValue","error"])])]),K("div",Ot,[K("div",Bt,[B(qt,{modelValue:A.value,"onUpdate:modelValue":a[13]||(a[13]=x=>A.value=x),"transition-prev":"jump-right","transition-next":"jump-left",animated:"","control-color":"white","prev-icon":"arrow_left","next-icon":"arrow_right",thumbnails:V.value.length!=0,infinite:"",height:"300px",class:"bg-primary text-white shadow-1 rounded-borders"},{default:H(()=>[V.value.length!=0?(L(!0),G(rt,{key:0},it(V.value,(x,W)=>(L(),le(Fe,{name:x,"img-src":x},{default:H(()=>[$.value?(L(),G("div",Qt,Rt)):be("",!0)]),_:2},1032,["name","img-src"]))),256)):(L(),le(Fe,{key:1,name:"blank",class:"column no-wrap flex-center"},{default:H(()=>[B($e,{name:"image",size:"56px"}),Lt]),_:1}))]),_:1},8,["modelValue","thumbnails"]),V.value.length!=0?(L(),G("div",Wt,[B(X,{unelevated:"",rounded:"",align:"between","icon-right":"delete",color:"primary",label:"Remove",onClick:Z}),B(X,{unelevated:"",rounded:"",align:"between","icon-right":"image",color:"primary",label:"Set as main",disabled:$.value,onClick:Ve},null,8,["disabled"])])):be("",!0),B(At,{onOnImagesUploaded:se}),B(X,{unelevated:"",rounded:"",align:"between","icon-right":"check",color:"primary",type:"submit"},{default:H(()=>[ut(st(T.value?"update":"create"),1)]),_:1})])])])]),_:1},512))}};export{Zt as _};
