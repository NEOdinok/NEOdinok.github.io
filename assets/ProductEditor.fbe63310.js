import{t as $e,v as J,x as Ve,y as ke,z as oe,A as se,C as me,E as ae,D as ce,r as k,a as C,w as j,i as ne,h as $,ay as De,bx as Ne,b as de,S as Ae,by as Te,c as ve,bz as ze,be as Ee,o as ue,l as Se,bA as fe,p as Oe,q as Me,T as Ue,bB as Be,f as Y,I as Qe,s as je,b7 as Re,bf as Le,b8 as We,ba as Ke,bg as Xe,bC as Ye,bh as pe,bD as He,b9 as Je,B as Ge,a4 as Fe,a7 as L,ag as te,ab as M,bE as Ze,a9 as K,Q as we,a0 as et,a1 as tt,aJ as at,a8 as le,ae as X,aL as re,aM as N,ai as nt,ah as ot,al as ge,ac as lt,ad as rt}from"./index.40f30db3.js";import{c as it,a as Ie,b as qe,u as ut,Q as ye}from"./QSelect.e7e31a16.js";import{g as be,s as he}from"./touch.3df10340.js";import{c as st,h as ct}from"./format.c7d4729a.js";import{Q as dt}from"./QForm.e3643f6a.js";import{u as vt,r as Z,i as xe,m as Ce}from"./index.67880895.js";function mt(e){const o=[.06,6,50];return typeof e=="string"&&e.length&&e.split(":").forEach((d,f)=>{const l=parseFloat(d);l&&(o[f]=l)}),o}var ft=$e({name:"touch-swipe",beforeMount(e,{value:o,arg:d,modifiers:f}){if(f.mouse!==!0&&J.has.touch!==!0)return;const l=f.mouseCapture===!0?"Capture":"",t={handler:o,sensitivity:mt(d),direction:be(f),noop:Ve,mouseStart(s){he(s,t)&&ke(s)&&(oe(t,"temp",[[document,"mousemove","move",`notPassive${l}`],[document,"mouseup","end","notPassiveCapture"]]),t.start(s,!0))},touchStart(s){if(he(s,t)){const m=s.target;oe(t,"temp",[[m,"touchmove","move","notPassiveCapture"],[m,"touchcancel","end","notPassiveCapture"],[m,"touchend","end","notPassiveCapture"]]),t.start(s)}},start(s,m){J.is.firefox===!0&&se(e,!0);const S=me(s);t.event={x:S.left,y:S.top,time:Date.now(),mouse:m===!0,dir:!1}},move(s){if(t.event===void 0)return;if(t.event.dir!==!1){ae(s);return}const m=Date.now()-t.event.time;if(m===0)return;const S=me(s),F=S.left-t.event.x,p=Math.abs(F),I=S.top-t.event.y,_=Math.abs(I);if(t.event.mouse!==!0){if(p<t.sensitivity[1]&&_<t.sensitivity[1]){t.end(s);return}}else if(window.getSelection().toString()!==""){t.end(s);return}else if(p<t.sensitivity[2]&&_<t.sensitivity[2])return;const D=p/m,z=_/m;t.direction.vertical===!0&&p<_&&p<100&&z>t.sensitivity[0]&&(t.event.dir=I<0?"up":"down"),t.direction.horizontal===!0&&p>_&&_<100&&D>t.sensitivity[0]&&(t.event.dir=F<0?"left":"right"),t.direction.up===!0&&p<_&&I<0&&p<100&&z>t.sensitivity[0]&&(t.event.dir="up"),t.direction.down===!0&&p<_&&I>0&&p<100&&z>t.sensitivity[0]&&(t.event.dir="down"),t.direction.left===!0&&p>_&&F<0&&_<100&&D>t.sensitivity[0]&&(t.event.dir="left"),t.direction.right===!0&&p>_&&F>0&&_<100&&D>t.sensitivity[0]&&(t.event.dir="right"),t.event.dir!==!1?(ae(s),t.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),st(),t.styleCleanup=g=>{t.styleCleanup=void 0,document.body.classList.remove("non-selectable");const V=()=>{document.body.classList.remove("no-pointer-events--children")};g===!0?setTimeout(V,50):V()}),t.handler({evt:s,touch:t.event.mouse!==!0,mouse:t.event.mouse,direction:t.event.dir,duration:m,distance:{x:p,y:_}})):t.end(s)},end(s){t.event!==void 0&&(ce(t,"temp"),J.is.firefox===!0&&se(e,!1),t.styleCleanup!==void 0&&t.styleCleanup(!0),s!==void 0&&t.event.dir!==!1&&ae(s),t.event=void 0)}};if(e.__qtouchswipe=t,f.mouse===!0){const s=f.mouseCapture===!0||f.mousecapture===!0?"Capture":"";oe(t,"main",[[e,"mousedown","mouseStart",`passive${s}`]])}J.has.touch===!0&&oe(t,"main",[[e,"touchstart","touchStart",`passive${f.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,o){const d=e.__qtouchswipe;d!==void 0&&(o.oldValue!==o.value&&(typeof o.value!="function"&&d.end(),d.handler=o.value),d.direction=be(o.modifiers))},beforeUnmount(e){const o=e.__qtouchswipe;o!==void 0&&(ce(o,"main"),ce(o,"temp"),J.is.firefox===!0&&se(e,!1),o.styleCleanup!==void 0&&o.styleCleanup(),delete e.__qtouchswipe)}});function pt(){const e=new Map;return{getCache:function(o,d){return e[o]===void 0?e[o]=d:e[o]},getCacheWithFn:function(o,d){return e[o]===void 0?e[o]=d():e[o]}}}const gt={name:{required:!0},disable:Boolean},Pe={setup(e,{slots:o}){return()=>$("div",{class:"q-panel scroll",role:"tabpanel"},de(o.default))}},yt={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},bt=["update:modelValue","beforeTransition","transition"];function ht(){const{props:e,emit:o,proxy:d}=ne(),{getCacheWithFn:f}=pt();let l,t;const s=k(null),m=k(null);function S(u){const P=e.vertical===!0?"up":"left";w((d.$q.lang.rtl===!0?-1:1)*(u.direction===P?1:-1))}const F=C(()=>[[ft,S,void 0,{horizontal:e.vertical!==!0,vertical:e.vertical,mouse:!0}]]),p=C(()=>e.transitionPrev||`slide-${e.vertical===!0?"down":"right"}`),I=C(()=>e.transitionNext||`slide-${e.vertical===!0?"up":"left"}`),_=C(()=>`--q-transition-duration: ${e.transitionDuration}ms`),D=C(()=>typeof e.modelValue=="string"||typeof e.modelValue=="number"?e.modelValue:String(e.modelValue)),z=C(()=>({include:e.keepAliveInclude,exclude:e.keepAliveExclude,max:e.keepAliveMax})),g=C(()=>e.keepAliveInclude!==void 0||e.keepAliveExclude!==void 0);j(()=>e.modelValue,(u,P)=>{const E=q(u)===!0?A(u):-1;t!==!0&&c(E===-1?0:E<A(P)?-1:1),s.value!==E&&(s.value=E,o("beforeTransition",u,P),Ae(()=>{o("transition",u,P)}))});function V(){w(1)}function R(){w(-1)}function r(u){o("update:modelValue",u)}function q(u){return u!=null&&u!==""}function A(u){return l.findIndex(P=>P.props.name===u&&P.props.disable!==""&&P.props.disable!==!0)}function b(){return l.filter(u=>u.props.disable!==""&&u.props.disable!==!0)}function c(u){const P=u!==0&&e.animated===!0&&s.value!==-1?"q-transition--"+(u===-1?p.value:I.value):null;m.value!==P&&(m.value=P)}function w(u,P=s.value){let E=P+u;for(;E>-1&&E<l.length;){const Q=l[E];if(Q!==void 0&&Q.props.disable!==""&&Q.props.disable!==!0){c(u),t=!0,o("update:modelValue",Q.props.name),setTimeout(()=>{t=!1});return}E+=u}e.infinite===!0&&l.length!==0&&P!==-1&&P!==l.length&&w(u,u===-1?l.length:-1)}function T(){const u=A(e.modelValue);return s.value!==u&&(s.value=u),!0}function i(){const u=q(e.modelValue)===!0&&T()&&l[s.value];return e.keepAlive===!0?[$(Te,z.value,[$(g.value===!0?f(D.value,()=>({...Pe,name:D.value})):Pe,{key:D.value,style:_.value},()=>u)])]:[$("div",{class:"q-panel scroll",style:_.value,key:D.value,role:"tabpanel"},[u])]}function v(){if(l.length!==0)return e.animated===!0?[$(De,{name:m.value},i)]:i()}function x(u){return l=Ne(de(u.default,[])).filter(P=>P.props!==null&&P.props.slot===void 0&&q(P.props.name)===!0),l.length}function U(){return l}return Object.assign(d,{next:V,previous:R,goTo:r}),{panelIndex:s,panelDirectives:F,updatePanelsList:x,updatePanelIndex:T,getPanelContent:v,getEnabledPanels:b,getPanels:U,isValidPanelName:q,keepAliveProps:z,needsUniqueKeepAliveWrapper:g,goToPanelByOffset:w,goToPanel:r,nextPanel:V,previousPanel:R}}var _e=ve({name:"QCarouselSlide",props:{...gt,imgSrc:String},setup(e,{slots:o}){const d=C(()=>e.imgSrc?{backgroundImage:`url("${e.imgSrc}")`}:{});return()=>$("div",{class:"q-carousel__slide",style:d.value},de(o.default))}});let ee=0;const xt={fullscreen:Boolean,noRouteFullscreenExit:Boolean},Ct=["update:fullscreen","fullscreen"];function Pt(){const e=ne(),{props:o,emit:d,proxy:f}=e;let l,t,s;const m=k(!1);ze(e)===!0&&j(()=>f.$route.fullPath,()=>{o.noRouteFullscreenExit!==!0&&p()}),j(()=>o.fullscreen,I=>{m.value!==I&&S()}),j(m,I=>{d("update:fullscreen",I),d("fullscreen",I)});function S(){m.value===!0?p():F()}function F(){m.value!==!0&&(m.value=!0,s=f.$el.parentNode,s.replaceChild(t,f.$el),document.body.appendChild(f.$el),ee++,ee===1&&document.body.classList.add("q-body--fullscreen-mixin"),l={handler:p},fe.add(l))}function p(){m.value===!0&&(l!==void 0&&(fe.remove(l),l=void 0),s.replaceChild(f.$el,t),m.value=!1,ee=Math.max(0,ee-1),ee===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),f.$el.scrollIntoView!==void 0&&setTimeout(()=>{f.$el.scrollIntoView()})))}return Ee(()=>{t=document.createElement("span")}),ue(()=>{o.fullscreen===!0&&F()}),Se(p),Object.assign(f,{toggleFullscreen:S,setFullscreen:F,exitFullscreen:p}),{inFullscreen:m,toggleFullscreen:S}}const _t=["top","right","bottom","left"],St=["regular","flat","outline","push","unelevated"];var Ft=ve({name:"QCarousel",props:{...Oe,...yt,...xt,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:e=>St.includes(e),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:e=>_t.includes(e)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...Ct,...bt],setup(e,{slots:o}){const{proxy:{$q:d}}=ne(),f=Me(e,d);let l=null,t;const{updatePanelsList:s,getPanelContent:m,panelDirectives:S,goToPanel:F,previousPanel:p,nextPanel:I,getEnabledPanels:_,panelIndex:D}=ht(),{inFullscreen:z}=Pt(),g=C(()=>z.value!==!0&&e.height!==void 0?{height:e.height}:{}),V=C(()=>e.vertical===!0?"vertical":"horizontal"),R=C(()=>`q-carousel q-panel-parent q-carousel--with${e.padding===!0?"":"out"}-padding`+(z.value===!0?" fullscreen":"")+(f.value===!0?" q-carousel--dark q-dark":"")+(e.arrows===!0?` q-carousel--arrows-${V.value}`:"")+(e.navigation===!0?` q-carousel--navigation-${b.value}`:"")),r=C(()=>{const v=[e.prevIcon||d.iconSet.carousel[e.vertical===!0?"up":"left"],e.nextIcon||d.iconSet.carousel[e.vertical===!0?"down":"right"]];return e.vertical===!1&&d.lang.rtl===!0?v.reverse():v}),q=C(()=>e.navigationIcon||d.iconSet.carousel.navigationIcon),A=C(()=>e.navigationActiveIcon||q.value),b=C(()=>e.navigationPosition||(e.vertical===!0?"right":"bottom")),c=C(()=>({color:e.controlColor,textColor:e.controlTextColor,round:!0,[e.controlType]:!0,dense:!0}));j(()=>e.modelValue,()=>{e.autoplay&&w()}),j(()=>e.autoplay,v=>{v?w():l!==null&&(clearTimeout(l),l=null)});function w(){const v=Be(e.autoplay)===!0?Math.abs(e.autoplay):5e3;l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,v>=0?I():p()},v)}ue(()=>{e.autoplay&&w()}),Se(()=>{l!==null&&clearTimeout(l)});function T(v,x){return $("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${v} q-carousel__navigation--${b.value}`+(e.controlColor!==void 0?` text-${e.controlColor}`:"")},[$("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},_().map(x))])}function i(){const v=[];if(e.navigation===!0){const x=o["navigation-icon"]!==void 0?o["navigation-icon"]:u=>$(Y,{key:"nav"+u.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${u.active===!0?"":"in"}active`,...u.btnProps,onClick:u.onClick}),U=t-1;v.push(T("buttons",(u,P)=>{const E=u.props.name,Q=D.value===P;return x({index:P,maxIndex:U,name:E,active:Q,btnProps:{icon:Q===!0?A.value:q.value,size:"sm",...c.value},onClick:()=>{F(E)}})}))}else if(e.thumbnails===!0){const x=e.controlColor!==void 0?` text-${e.controlColor}`:"";v.push(T("thumbnails",U=>{const u=U.props;return $("img",{key:"tmb#"+u.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${u.name===e.modelValue?"":"in"}active`+x,src:u.imgSrc||u["img-src"],onClick:()=>{F(u.name)}})}))}return e.arrows===!0&&D.value>=0&&((e.infinite===!0||D.value>0)&&v.push($("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${V.value} absolute flex flex-center`},[$(Y,{icon:r.value[0],...c.value,onClick:p})])),(e.infinite===!0||D.value<t-1)&&v.push($("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${V.value} absolute flex flex-center`},[$(Y,{icon:r.value[1],...c.value,onClick:I})]))),Qe(o.control,v)}return()=>(t=s(o),$("div",{class:R.value,style:g.value},[Ue("div",{class:"q-carousel__slides-container"},m(),"sl-cont",e.swipeable,()=>S.value)].concat(i())))}});function H(e,o,d,f){const l=[];return e.forEach(t=>{f(t)===!0?l.push(t):o.push({failedPropValidation:d,file:t})}),l}function ie(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),ae(e)}const wt={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},It=["rejected"];function qt({editable:e,dnd:o,getFileInput:d,addFilesToQueue:f}){const{props:l,emit:t,proxy:s}=ne(),m=k(null),S=C(()=>l.accept!==void 0?l.accept.split(",").map(r=>(r=r.trim(),r==="*"?"*/":(r.endsWith("/*")&&(r=r.slice(0,r.length-1)),r.toUpperCase()))):null),F=C(()=>parseInt(l.maxFiles,10)),p=C(()=>parseInt(l.maxTotalSize,10));function I(r){if(e.value)if(r!==Object(r)&&(r={target:null}),r.target!==null&&r.target.matches('input[type="file"]')===!0)r.clientX===0&&r.clientY===0&&je(r);else{const q=d();q&&q!==r.target&&q.click(r)}}function _(r){e.value&&r&&f(null,r)}function D(r,q,A,b){let c=Array.from(q||r.target.files);const w=[],T=()=>{w.length!==0&&t("rejected",w)};if(l.accept!==void 0&&S.value.indexOf("*/")===-1&&(c=H(c,w,"accept",i=>S.value.some(v=>i.type.toUpperCase().startsWith(v)||i.name.toUpperCase().endsWith(v))),c.length===0))return T();if(l.maxFileSize!==void 0){const i=parseInt(l.maxFileSize,10);if(c=H(c,w,"max-file-size",v=>v.size<=i),c.length===0)return T()}if(l.multiple!==!0&&c.length!==0&&(c=[c[0]]),c.forEach(i=>{i.__key=i.webkitRelativePath+i.lastModified+i.name+i.size}),b===!0){const i=A.map(v=>v.__key);c=H(c,w,"duplicate",v=>i.includes(v.__key)===!1)}if(c.length===0)return T();if(l.maxTotalSize!==void 0){let i=b===!0?A.reduce((v,x)=>v+x.size,0):0;if(c=H(c,w,"max-total-size",v=>(i+=v.size,i<=p.value)),c.length===0)return T()}if(typeof l.filter=="function"){const i=l.filter(c);c=H(c,w,"filter",v=>i.includes(v))}if(l.maxFiles!==void 0){let i=b===!0?A.length:0;if(c=H(c,w,"max-files",()=>(i++,i<=F.value)),c.length===0)return T()}if(T(),c.length!==0)return c}function z(r){ie(r),o.value!==!0&&(o.value=!0)}function g(r){ae(r),(r.relatedTarget!==null||J.is.safari!==!0?r.relatedTarget!==m.value:document.elementsFromPoint(r.clientX,r.clientY).includes(m.value)===!1)===!0&&(o.value=!1)}function V(r){ie(r);const q=r.dataTransfer.files;q.length!==0&&f(null,q),o.value=!1}function R(r){if(o.value===!0)return $("div",{ref:m,class:`q-${r}__dnd absolute-full`,onDragenter:ie,onDragover:ie,onDragleave:g,onDrop:V})}return Object.assign(s,{pickFiles:I,addFiles:_}),{pickFiles:I,addFiles:_,onDragover:z,onDragleave:g,processFiles:D,getDndNode:R,maxFilesNumber:F,maxTotalSizeNumber:p}}var $t=ve({name:"QFile",inheritAttrs:!1,props:{...Re,...Le,...wt,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...We,...It],setup(e,{slots:o,emit:d,attrs:f}){const{proxy:l}=ne(),t=Ke(),s=k(null),m=k(!1),S=Xe(e),{pickFiles:F,onDragover:p,onDragleave:I,processFiles:_,getDndNode:D}=qt({editable:t.editable,dnd:m,getFileInput:U,addFilesToQueue:u}),z=Ye(e),g=C(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),V=C(()=>pe(g.value)),R=C(()=>g.value.map(y=>y.name).join(", ")),r=C(()=>ct(g.value.reduce((y,O)=>y+O.size,0))),q=C(()=>({totalSize:r.value,filesNumber:g.value.length,maxFiles:e.maxFiles})),A=C(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:S.value,...f,id:t.targetUid.value,disabled:t.editable.value!==!0})),b=C(()=>"q-file q-field--auto-height"+(m.value===!0?" q-file--dnd":"")),c=C(()=>e.multiple===!0&&e.append===!0);function w(y){const O=g.value.slice();O.splice(y,1),i(O)}function T(y){const O=g.value.indexOf(y);O>-1&&w(O)}function i(y){d("update:modelValue",e.multiple===!0?y:y[0])}function v(y){y.keyCode===13&&Ge(y)}function x(y){(y.keyCode===13||y.keyCode===32)&&F(y)}function U(){return s.value}function u(y,O){const B=_(y,O,g.value,c.value),G=U();G!=null&&(G.value=""),B!==void 0&&((e.multiple===!0?e.modelValue&&B.every(a=>g.value.includes(a)):e.modelValue===B[0])||i(c.value===!0?g.value.concat(B):B))}function P(){return[$("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function E(){if(o.file!==void 0)return g.value.length===0?P():g.value.map((O,B)=>o.file({index:B,file:O,ref:this}));if(o.selected!==void 0)return g.value.length===0?P():o.selected({files:g.value,ref:this});if(e.useChips===!0)return g.value.length===0?P():g.value.map((O,B)=>$(it,{key:"file-"+B,removable:t.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{w(B)}},()=>$("span",{class:"ellipsis",textContent:O.name})));const y=e.displayValue!==void 0?e.displayValue:R.value;return y.length!==0?[$("div",{class:e.inputClass,style:e.inputStyle,textContent:y})]:P()}function Q(){const y={ref:s,...A.value,...z.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:u};return e.multiple===!0&&(y.multiple=!0),$("input",y)}return Object.assign(t,{fieldClass:b,emitValue:i,hasValue:V,inputRef:s,innerValue:g,floatingLabel:C(()=>V.value===!0||pe(e.displayValue)),computedCounter:C(()=>{if(e.counterLabel!==void 0)return e.counterLabel(q.value);const y=e.maxFiles;return`${g.value.length}${y!==void 0?" / "+y:""} (${r.value})`}),getControlChild:()=>D("file"),getControl:()=>{const y={ref:t.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return t.editable.value===!0&&Object.assign(y,{onDragover:p,onDragleave:I,onKeydown:v,onKeyup:x}),$("div",y,[Q()].concat(E()))}}),Object.assign(l,{removeAtIndex:w,removeFile:T,getNativeElement:()=>s.value}),He(l,"nativeEl",()=>s.value),Je(t)}});const Vt={class:""},kt={__name:"FirebaseUpload",emits:["onImagesUploaded"],setup(e,{emit:o}){Fe();const{triggerSpinner:d}=Ie(),{uploadImagesToFirebaseStorage:f}=qe(),l=k([]),t=k(null),s=C(()=>t.value!==null),m=async()=>{try{const S=d("loading images...");l.value=[],l.value=await f(t.value),l.value&&S(),o("onImagesUploaded",l.value),t.value=null}catch(S){console.warn({error:S})}};return(S,F)=>(L(),te("div",Vt,[M($t,{modelValue:t.value,"onUpdate:modelValue":F[0]||(F[0]=p=>t.value=p),label:"Add images to upload",class:"q-pt-md",accept:".jpg, image/*",outlined:"",counter:"",clearable:"",multiple:"",append:"","use-chips":""},Ze({prepend:K(()=>[M(we,{name:"attach_file"})]),_:2},[s.value?{name:"after",fn:K(()=>[M(Y,{color:"green",rounded:"",dense:"",icon:"cloud_upload",disable:!s.value,onClick:m},null,8,["disable"])]),key:"0"}:void 0]),1032,["modelValue"])]))}};const Dt={class:"row justify-center"},Nt={class:"col-12 col-sm-6 col-md-4"},At={class:"q-pa-md"},Tt={key:1},zt={class:"col-12 col-sm-6 col-md-4"},Et={class:"q-pa-md"},Ot={key:0,class:"custom-caption absolute-top"},Mt=X("div",{class:"text-h2"},"Main Image",-1),Ut=[Mt],Bt=X("div",{class:"q-mt-md text-center"}," Add product images below ",-1),Qt={key:0,class:"row q-gutter-sm q-pt-md"},Yt={__name:"ProductEditor",props:{productId:{type:String,required:!1}},setup(e){const o=e,{getCategoryDocsFromFirebase:d,getSubcategoryDocsFromFirebase:f,createProductInFirebase:l,getProductFromFirebase:t,updateProductInFirebase:s}=ut(),{updateMainImageInFirebase:m,removeImageFromFirebaseStorage:S}=qe();Fe();const{triggerNegative:F,triggerPositive:p}=Ie(),I=k([]),_=k([]),D=k([]),z=k([]),g=k(null),V=k(null),R=k(""),r=k("blank"),q=k(null),A=k(!1),b=k([]),c=k([]);et();const w=tt(),T=k(!1),i=at({productName:"",productPrice:"",productQuantity:"",productCategory:"",productSubCategory:"",productDescription:""}),v={productName:{required:Z,$lazy:!0},productPrice:{required:Z,integer:xe,minValue:Ce(1),$lazy:!0},productQuantity:{required:Z,integer:xe,minValue:Ce(1),$lazy:!0},productCategory:{required:Z,$lazy:!0},productSubCategory:{$lazy:!1},productDescription:{required:Z,$lazy:!0}},x=vt(v,i),U=C(()=>!!o.productId);ue(async()=>{if(U.value)try{const a=await t(o.productId);a&&u(a)}catch(a){console.warn({error:a})}}),ue(async()=>{try{const{categoriesData:a}=await d();I.value=a.value}catch({error:a}){console.warn({error:a})}});const u=a=>{i.productName=a.name,i.productPrice=a.price,i.productQuantity=a.quantity,i.productDescription=a.description,i.productCategory=a.category,i.productSubCategory=a.subCategory,g.value=a.category,V.value=a.subCategory,b.value=a.imagesData,c.value=a.imageUrls,r.value=a.imagesData.find(n=>n.isMain===!0).url},P=async()=>{try{if(!await N(x).$validate())F("Fill in all the fields");else if(b.value.length==0)F("Please upload product images");else if(!q.value)F("Please select a main image");else{const n={name:i.productName,price:i.productPrice,quantity:i.productQuantity,category:g.value,subCategory:V.value,description:i.productDescription,imagesData:b.value,imageUrls:c.value};U.value?await E(n):await Q(n)}}catch(a){console.warn({error:a})}},E=async a=>{try{await s(o.productId,a)}catch(n){console.warn({error:n})}},Q=async a=>{try{const n=await l(a);p(`Product ${a.name} created`),w.push(`/products/edit/${n}`)}catch(n){console.warn({error:n})}};j(r,a=>{const n=b.value.find(h=>h.url==a);n&&n.isMain==!0?A.value=!0:A.value=!1}),j(I,()=>{_.value=I.value.map(a=>({label:a.categoryName,value:a.categoryId}))}),j(V,a=>{try{if(a)i.productSubCategory=a;else{i.productSubCategory="";return}}catch(n){console.warn({error:n})}i.productSubCategory=a}),j(g,async a=>{try{if(a){i.productCategory=a;const{subcategoriesData:n}=await f(a);D.value=n.value,T.value&&(V.value="")}}catch(n){console.warn({error:n})}}),j(D,a=>{z.value=a.map(n=>({label:n.subCategoryName,value:n.subCategoryId}))});const y=async()=>{const a=[];b.value.forEach(W=>{W.url!=r.value&&a.push(W)});let n=b.value.find(W=>W.url==r.value),h=b.value.indexOf(n);await S(n),b.value=a,c.value=[],b.value.forEach(W=>{c.value.push(W.url)}),h==0?r.value=b.value[0].url:r.value=b.value[h-1].url},O=a=>{console.log("[editor] uploaded event. uploadedImagesData:",a),a.forEach(n=>{b.value.push(n),c.value.push(n.url)}),r.value=b.value[0].url},B=async()=>{console.log("[editor] about to find and remove main from",b.value.find(h=>h.isMain===!0)),G();let a=b.value.find(h=>h.url==r.value),n=b.value.indexOf(a);a.isMain=!0,b.value[n]=a,A.value=!0,q.value=a,console.log("[editor] changed main to",q.value.url),console.log("[editor] update end. imagesData:",b.value)},G=()=>{let a=b.value.find(n=>n.isMain===!0);if(console.log("[findAndRemove]:",a),a){let n=b.value.indexOf(a);a.isMain=!1,b.value[n]=a}};return(a,n)=>(L(),le(dt,{ref_key:"createProductForm",ref:R,onSubmit:P},{default:K(()=>[X("div",Dt,[X("div",Nt,[X("div",At,[M(re,{outlined:"",label:"Product name",class:"q-pb-lg",modelValue:i.productName,"onUpdate:modelValue":n[0]||(n[0]=h=>i.productName=h),"error-message":"Product name is required","bottom-slots":"",error:N(x).productName.$invalid&&N(x).productName.$dirty,"onUpdate:model":n[1]||(n[1]=h=>N(x).productName.$touch())},null,8,["modelValue","error"]),M(re,{outlined:"",label:"Product price",class:"q-pb-lg",modelValue:i.productPrice,"onUpdate:modelValue":[n[2]||(n[2]=h=>i.productPrice=h),n[3]||(n[3]=h=>N(x).productPrice.$touch())],"error-message":"Please enter valid price","bottom-slots":"",error:N(x).productPrice.$invalid&&N(x).productPrice.$dirty},null,8,["modelValue","error"]),M(re,{class:"q-pb-lg",label:"Product quantity",modelValue:i.productQuantity,"onUpdate:modelValue":[n[4]||(n[4]=h=>i.productQuantity=h),n[5]||(n[5]=h=>N(x).productQuantity.$touch())],"error-message":"Please enter valid quantity",outlined:"","bottom-slots":"",error:N(x).productQuantity.$invalid&&N(x).productQuantity.$dirty},null,8,["modelValue","error"]),_.value.length?(L(),le(ye,{key:0,outlined:"",label:"Parent category",class:"q-pb-lg","error-message":"Please select a parent category",options:_.value,modelValue:g.value,"onUpdate:modelValue":[n[6]||(n[6]=h=>g.value=h),n[7]||(n[7]=h=>N(x).productCategory.$touch())],error:N(x).productCategory.$invalid&&N(x).productCategory.$dirty,onPopupShow:n[8]||(n[8]=h=>T.value=!0)},null,8,["options","modelValue","error"])):(L(),te("p",Tt,"No product categories")),M(ye,{outlined:"",label:"Product Subcategory",class:"q-pb-lg",modelValue:V.value,"onUpdate:modelValue":[n[9]||(n[9]=h=>V.value=h),n[10]||(n[10]=h=>N(x).productSubCategory.$touch())],options:z.value,"error-message":"Please select a subcategory",error:N(x).productSubCategory.$invalid&&N(x).productSubCategory.$dirty},null,8,["modelValue","options","error"]),M(re,{filled:"",clearable:"",autogrow:"",type:"textarea",color:"primary",label:"Product Description",modelValue:i.productDescription,"onUpdate:modelValue":[n[11]||(n[11]=h=>i.productDescription=h),n[12]||(n[12]=h=>N(x).productDescription.$touch())],"error-message":"Please enter product description",error:N(x).productDescription.$invalid&&N(x).productDescription.$dirty},null,8,["modelValue","error"])])]),X("div",zt,[X("div",Et,[M(Ft,{modelValue:r.value,"onUpdate:modelValue":n[13]||(n[13]=h=>r.value=h),"transition-prev":"jump-right","transition-next":"jump-left",animated:"","control-color":"white","prev-icon":"arrow_left","next-icon":"arrow_right",thumbnails:c.value.length!=0,infinite:"",height:"300px",class:"bg-primary text-white shadow-1 rounded-borders"},{default:K(()=>[c.value.length!=0?(L(!0),te(nt,{key:0},ot(c.value,(h,W)=>(L(),le(_e,{name:h,"img-src":h},{default:K(()=>[A.value?(L(),te("div",Ot,Ut)):ge("",!0)]),_:2},1032,["name","img-src"]))),256)):(L(),le(_e,{key:1,name:"blank",class:"column no-wrap flex-center"},{default:K(()=>[M(we,{name:"image",size:"56px"}),Bt]),_:1}))]),_:1},8,["modelValue","thumbnails"]),c.value.length!=0?(L(),te("div",Qt,[M(Y,{unelevated:"",rounded:"",align:"between","icon-right":"delete",color:"primary",label:"Remove",onClick:y}),M(Y,{unelevated:"",rounded:"",align:"between","icon-right":"image",color:"primary",label:"Set as main",disabled:A.value,onClick:B},null,8,["disabled"])])):ge("",!0),M(kt,{onOnImagesUploaded:O}),M(Y,{unelevated:"",rounded:"",align:"between","icon-right":"check",color:"primary",type:"submit"},{default:K(()=>[lt(rt(U.value?"update":"create"),1)]),_:1})])])])]),_:1},512))}};export{Yt as _};
